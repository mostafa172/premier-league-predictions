<div class="leaderboard-container">
  <div class="leaderboard-header">
    <h2>Leaderboard</h2>
    <button (click)="refreshLeaderboard()" class="refresh-btn" [disabled]="loading">
      ðŸ”„ Refresh
    </button>
  </div>

  <div *ngIf="error" class="error-message">
    {{ error }}
  </div>

  <div *ngIf="loading" class="loading-message">
    Loading leaderboard...
  </div>

  <div *ngIf="currentUsername && currentUserRank > 0" class="current-user-rank">
    <h3>Your Position: #{{ currentUserRank }}</h3>
  </div>

  <div *ngIf="!loading && leaderboard.length > 0" class="leaderboard-table">
    <table>
      <thead>
        <tr>
          <th>Rank</th>
          <th>Username</th>
          <th>Points</th>
          <th>Predictions</th>
          <th>Avg Points</th>
        </tr>
      </thead>
      <tbody>
        <tr 
          *ngFor="let entry of leaderboard; trackBy: trackByUserId"
          [class.current-user]="entry.username === currentUsername"
        >
          <td class="rank">
            <span class="rank-number">{{ entry.rank }}</span>
            <span *ngIf="entry.rank === 1" class="trophy">ðŸ¥‡</span>
            <span *ngIf="entry.rank === 2" class="trophy">ðŸ¥ˆ</span>
            <span *ngIf="entry.rank === 3" class="trophy">ðŸ¥‰</span>
          </td>
          <td class="username">{{ entry.username }}</td>
          <td class="points">
            <span class="points-number">{{ entry.totalPoints || 0 }}</span>
          </td>
          <td class="predictions">{{ entry.totalPredictions || 0 }}</td>
          <td class="avg-points">
            {{ entry.totalPredictions > 0 ? (entry.totalPoints / entry.totalPredictions).toFixed(2) : '0.00' }}
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="!loading && leaderboard.length === 0" class="no-data">
    No leaderboard data available yet.
  </div>
</div>