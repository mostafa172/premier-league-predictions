<div class="leaderboard-container">
  <div class="leaderboard-header">
    <h2>Leaderboard</h2>
    <button
      (click)="refreshLeaderboard()"
      class="refresh-btn"
      [disabled]="loading"
    >
      Refresh
    </button>
  </div>

  <div *ngIf="error" class="error-message">{{ error }}</div>
  <div *ngIf="loading" class="loading-message">Loading leaderboard...</div>

  <div *ngIf="currentUsername && currentUserRank > 0" class="current-user-rank">
    <h3>Your Position: #{{ currentUserRank }}</h3>
  </div>

  <div *ngIf="!loading && leaderboard.length > 0" class="leaderboard-table">
    <table>
      <thead>
        <tr>
          <th class="th-rank">Rank</th>
          <th class="th-username">Username</th>
          <th class="th-points">Points</th>
        </tr>
      </thead>

      <tbody>
        <tr
          *ngFor="let entry of leaderboard; trackBy: trackByUserId"
          [class.current-user]="entry.username === currentUsername"
        >
          <td class="rank">
            <ng-container [ngSwitch]="entry.rank">
              <span *ngSwitchCase="1" class="trophy" aria-label="1st">ðŸ¥‡</span>
              <span *ngSwitchCase="2" class="trophy" aria-label="2nd">ðŸ¥ˆ</span>
              <span *ngSwitchCase="3" class="trophy" aria-label="3rd">ðŸ¥‰</span>
              <span *ngSwitchDefault class="rank-number">{{ entry.rank }}</span>
            </ng-container>
          </td>

          <td class="username-cell">
            <div class="username">
              <span class="name">{{ entry.username }}</span>
              <span *ngIf="entry.username === currentUsername" class="you-label"
                >You</span
              >
            </div>
          </td>

          <td class="points">
            <span class="points-number">{{ entry.totalPoints || 0 }}</span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="!loading && leaderboard.length === 0" class="no-data">
    No leaderboard data available yet.
  </div>
</div>
